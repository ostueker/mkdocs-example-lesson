{% extends "base.html" %}

{% block content %}
{{ super() }}
<hr>

{# include 'partials/syllabus.html' #}

{# initialize variables #}
{% set lesson_number = 0 %}
{% set day = 0 %}
{% set multiday = false %}
{% set ns = namespace(current=0) %}
{% if config.start_time %}
  {% set ns.current = config.start_time %}
{% endif %}

{# check whether this is a multiday lesson #}

{% for episode in nav.pages if 'episodes' in episode.url %}
  {% if episode.meta.stat %}
    {% set multiday = True %}
  {% endif %}
{% endfor %}

<table class="table table-striped table-hover" style="border: 1;">
  <tr>
    {% if multiday %}<td class="col-md-1"></td>{% endif %}
    <td class="{% if multiday %}col-md-1{% else %}col-md-2{% endif %}"></td>
    <td class="col-md-3"><a href="/setup">Setup</a></td>
    <td class="col-md-7">Download files required for the lesson</td>
  </tr>

{% for episode in nav.pages if 'episodes' in episode.url %}
  <tr>
    {% if multiday %}<td class="col-md-1"></td>{% endif %}
    <td class="{% if multiday %}col-md-1{% else %}col-md-2{% endif %}">
      {{ "{:02d}:{:02d}".format(ns.current // 60, ns.current % 60 ) }}
    </td>
    <td class="col-md-3"><a href="{{ episode.url }}">{{ episode.meta.title }}</a></td>
    <td class="col-md-7">
      {% if episode.meta.break %}
        Break
      {% else %}
        {% for question in episode.meta.questions %}
          {{ question | markdown }}
        {% endfor %}
      {% endif %}
    </td>
  </tr>
  {% if episode.meta.teaching  is number %}{% set ns.current = ns.current + episode.meta.teaching  %}{% endif %}
  {% if episode.meta.exercises is number %}{% set ns.current = ns.current + episode.meta.exercises %}{% endif %}
  {% if episode.meta.break     is number %}{% set ns.current = ns.current + episode.meta.break     %}{% endif %}
{% endfor %}

  <tr>
    {% if multiday %}<td class="col-md-1"></td>{% endif %}
    <td class="{% if multiday %}col-md-1{% else %}col-md-2{% endif %}">{{ "{:02d}:{:02d}".format(ns.current // 60, ns.current % 60) }}</td>
    <td class="col-md-3">Finish</td>
    <td class="col-md-7"></td>
  </tr>
  </table>


{% endblock %}
